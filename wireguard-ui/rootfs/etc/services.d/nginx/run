#!/usr/bin/with-contenv bashio
# ==============================================================================
# Home Assistant Community Add-on: Wireguard UI
# Runs the Nginx daemon
# ==============================================================================

bashio::log.info "Starting NGinx..."

WGUI_BASEPATH="${HOSTNAME/-/_}"
(
set -x
if grep -F /WGUI_BASEPATH/ /etc/nginx/servers/ingress.conf; then
  sed -i 's/\/WGUI_BASEPATH\//\/'"${WGUI_BASEPATH}"'\/ingress\//' /etc/nginx/servers/ingress.conf
fi
)
exec nginx
